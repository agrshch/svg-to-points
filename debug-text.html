<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Text Path Extractor Debug</title>
    <style>
        body {
            font-family: 'Monaco', 'Menlo', 'Courier New', monospace;
            margin: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .controls {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        label {
            font-weight: bold;
            color: #555;
        }
        input, select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
        }
        button {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
        }
        button:hover {
            background: #0056b3;
        }
        .visualization {
            border: 2px solid #ddd;
            border-radius: 8px;
            margin: 20px 0;
            background: white;
        }
        canvas {
            display: block;
            border-radius: 6px;
        }
        .info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-size: 14px;
            line-height: 1.4;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            font-size: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç SVG Text Path Extractor Debug</h1>
        
        <div class="controls">
            <div class="control-group">
                <label for="pointDensity">Point Density:</label>
                <input type="number" id="pointDensity" value="8" min="1" max="50" step="1">
            </div>
            
            <div class="control-group">
                <label for="showPoints">Show Points:</label>
                <input type="checkbox" id="showPoints" checked>
            </div>
            
            <div class="control-group">
                <label for="showLines">Show Lines:</label>
                <input type="checkbox" id="showLines" checked>
            </div>
            
            <div class="control-group">
                <label for="pointSize">Point Size:</label>
                <input type="range" id="pointSize" min="1" max="8" value="2">
            </div>
            
            <button onclick="runTest()">üöÄ Extract & Visualize</button>
        </div>

        <div class="legend" style="flex-wrap: wrap;">
            <div class="legend-item">
                <div class="legend-color" style="background: #ff6b6b;"></div>
                <span>F</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #4ecdc4;"></div>
                <span>U</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #45b7d1;"></div>
                <span>T</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #96ceb4;"></div>
                <span>U</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #feca57;"></div>
                <span>R</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ff9ff3;"></div>
                <span>E</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #a8e6cf;"></div>
                <span>H</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #dda0dd;"></div>
                <span>U</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #98d8c8;"></div>
                <span>M</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #fdcb6e;"></div>
                <span>A</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #6c5ce7;"></div>
                <span>N</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #0984e3;"></div>
                <span>üî∑ Rectangle</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #00b894;"></div>
                <span>‚≠ï Circle</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #e17055;"></div>
                <span>‚¨ü Hexagon</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #a29bfe;"></div>
                <span>‚≠ï Ellipse</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #fd79a8;"></div>
                <span>‚≠ê Star</span>
            </div>
        </div>
        
        <div class="visualization">
            <canvas id="canvas" width="1000" height="600"></canvas>
        </div>
        
        <div id="info" class="info">–ù–∞–∂–º–∏—Ç–µ "Extract & Visualize" –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞...</div>
    </div>

    <script src="svg-path-extractor.js"></script>
    <script>
        // –¶–≤–µ—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—É—Ç–µ–π
        const colors = [
            '#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', 
            '#feca57', '#ff9ff3', '#a8e6cf', '#dda0dd',
            '#98d8c8', '#fdcb6e', '#6c5ce7', '#0984e3',
            '#00b894', '#e17055', '#a29bfe', '#fd79a8'
        ];

        async function runTest() {
            const pointDensity = parseInt(document.getElementById('pointDensity').value);
            const showPoints = document.getElementById('showPoints').checked;
            const showLines = document.getElementById('showLines').checked;
            const pointSize = parseInt(document.getElementById('pointSize').value);
            
            const infoDiv = document.getElementById('info');
            infoDiv.textContent = '–ó–∞–≥—Ä—É–∂–∞–µ–º SVG –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ—á–∫–∏...';
            
            try {
                // SVG –∫–æ–Ω—Ç–µ–Ω—Ç –≤—Å—Ç—Ä–æ–µ–Ω –ø—Ä—è–º–æ –≤ –∫–æ–¥
                const svgContent = `<svg width="1000" height="1000" viewBox="0 0 1000 1000" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M591 133H648.654V157.097H616.35V200.605H641.7V225.817H616.35V273.788H650V299H591V133Z" fill="black"/>
<path d="M518.397 277.479V352H493V185H534.13C550.987 185 559.528 192.183 559.528 210.813V240.442C559.528 254.359 553.01 259.746 548.515 261.766C554.134 264.235 559.528 268.724 559.528 279.948V338.532C559.528 345.266 560.876 348.409 562 350.878V352H536.827C535.704 350.204 534.355 347.286 534.355 338.308V288.028C534.355 280.621 533.007 277.479 524.915 277.479H518.397ZM518.397 207.671V253.685H525.14C532.107 253.685 534.355 249.196 534.355 241.789V218.445C534.355 211.262 532.782 207.671 525.14 207.671H518.397Z" fill="black"/>
<path d="M462 378.849C462 402.275 452.574 417 430.132 417H425.644C403.201 417 394 402.721 394 378.849V249H419.809V380.41C419.809 387.55 422.277 392.235 427.888 392.235C433.947 392.235 436.191 387.773 436.191 380.41V249H462V378.849Z" fill="black"/>
<path d="M365 336.242H343.924V479H319.076V336.242H298V312H365V336.242Z" fill="black"/>
<path d="M269 505.622C269 529.187 259.574 544 237.132 544H232.644C210.201 544 201 529.636 201 505.622V375H226.809V507.193C226.809 514.374 229.277 519.088 234.888 519.088C240.947 519.088 243.191 514.599 243.191 507.193V375H269V505.622Z" fill="black"/>
<path d="M115 605V439H173V463.097H140.502V506.828H166.23V532.04H140.502V605H115Z" fill="black"/>
<path d="M809 681H831.629L853.149 770.56V681H876V848H855.589L831.629 751.93V848H809V681Z" fill="black"/>
<path d="M757.627 784L754.273 752.763H735.938L732.584 784H710L730.348 618H760.311L782 784H757.627ZM738.398 727.997H751.59L744.882 666.64L738.398 727.997Z" fill="black"/>
<path d="M596 721V554H628.429L640.506 642.214L652.807 554H683V721H659.293V613.034L644.085 721H634.021L618.589 613.034V721H596Z" fill="black"/>
<path d="M564 620.849C564 644.275 554.713 659 532.601 659H528.178C506.066 659 497 644.721 497 620.849V491H522.429V622.41C522.429 629.55 524.861 634.235 530.389 634.235C536.36 634.235 538.571 629.773 538.571 622.41V491H564V620.849Z" fill="black"/>
<path d="M439.64 604V530.601H422.36V604H397V437H422.36V503.89H439.64V437H465V604H439.64Z" fill="black"/>
</svg>`;
                
                // –ò–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ—á–∫–∏
                const startTime = performance.now();
                const extractor = new SVGPathExtractor({ pointDensity });
                const pathsWithMetadata = await extractor.extractPointsWithMetadata(svgContent);
                const endTime = performance.now();
                
                // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                const totalPoints = pathsWithMetadata.reduce((sum, path) => sum + path.points.length, 0);
                const processingTime = (endTime - startTime).toFixed(2);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
                window.lastPathsData = pathsWithMetadata;
                
                // –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
                visualizePaths(pathsWithMetadata, showPoints, showLines, pointSize);
                
                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                let info = `üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø:
`;
                info += `‚è±Ô∏è  –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: ${processingTime} –º—Å
`;
                info += `üìç –í—Å–µ–≥–æ —Ç–æ—á–µ–∫: ${totalPoints.toLocaleString()}
`;
                info += `üìÑ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—É—Ç–µ–π: ${pathsWithMetadata.length}
`;
                info += `üéØ –ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Ç–æ—á–µ–∫: ${pointDensity}
`;
                info += `
üìã –î–ï–¢–ê–õ–ò –ü–û –ü–£–¢–Ø–ú:
`;
                
                pathsWithMetadata.forEach((pathData, index) => {
                    const elementNames = [
                        'F', 'U', 'T', 'U', 'R', 'E', 'H', 'U', 'M', 'A', 'N', 
                        'üî∑ Rectangle', '‚≠ï Circle', '‚¨ü Hexagon', '‚≠ï Ellipse', '‚≠ê Star'
                    ];
                    const name = elementNames[index] || `Element ${index + 1}`;
                    info += `  ${name}: ${pathData.points.length} —Ç–æ—á–µ–∫ (${pathData.element})
`;
                });
                
                infoDiv.textContent = info;
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                infoDiv.textContent = `‚ùå –û–®–ò–ë–ö–ê: ${error.message}`;
            }
        }

        function visualizePaths(pathsWithMetadata, showPoints, showLines, pointSize) {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const scale = 0.8;
            const offsetX = 50;
            const offsetY = 50;
            
            pathsWithMetadata.forEach((pathData, pathIndex) => {
                const color = colors[pathIndex % colors.length];
                const points = pathData.points;
                
                if (points.length === 0) return;
                
                // –†–∏—Å—É–µ–º –ª–∏–Ω–∏–∏
                if (showLines) {
                    ctx.strokeStyle = color;
                    ctx.lineWidth = 1.5;
                    ctx.beginPath();
                    points.forEach((point, index) => {
                        const x = point.x * scale + offsetX;
                        const y = point.y * scale + offsetY;
                        if (index === 0) {
                            ctx.moveTo(x, y);
                        } else {
                            ctx.lineTo(x, y);
                        }
                    });
                    ctx.stroke();
                }
                
                // –†–∏—Å—É–µ–º —Ç–æ—á–∫–∏
                if (showPoints) {
                    ctx.fillStyle = color;
                    points.forEach(point => {
                        const x = point.x * scale + offsetX;
                        const y = point.y * scale + offsetY;
                        ctx.beginPath();
                        ctx.arc(x, y, pointSize, 0, 2 * Math.PI);
                        ctx.fill();
                    });
                }
            });
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', runTest);
        
        // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        document.getElementById('pointDensity').addEventListener('change', runTest);
        document.getElementById('showPoints').addEventListener('change', () => {
            // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –±–µ–∑ –ø–µ—Ä–µ–≤—ã—á–∏—Å–ª–µ–Ω–∏—è
            const pointDensity = parseInt(document.getElementById('pointDensity').value);
            const showPoints = document.getElementById('showPoints').checked;
            const showLines = document.getElementById('showLines').checked;
            const pointSize = parseInt(document.getElementById('pointSize').value);
            
            // –ï—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö
            if (window.lastPathsData) {
                visualizePaths(window.lastPathsData, showPoints, showLines, pointSize);
            }
        });
        
        document.getElementById('showLines').addEventListener('change', () => {
            const showPoints = document.getElementById('showPoints').checked;
            const showLines = document.getElementById('showLines').checked;
            const pointSize = parseInt(document.getElementById('pointSize').value);
            
            if (window.lastPathsData) {
                visualizePaths(window.lastPathsData, showPoints, showLines, pointSize);
            }
        });
        
        document.getElementById('pointSize').addEventListener('input', () => {
            const showPoints = document.getElementById('showPoints').checked;
            const showLines = document.getElementById('showLines').checked;
            const pointSize = parseInt(document.getElementById('pointSize').value);
            
            if (window.lastPathsData) {
                visualizePaths(window.lastPathsData, showPoints, showLines, pointSize);
            }
        });
    </script>
</body>
</html> 