<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Path Extractor - Standalone Demo</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .demo-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .svg-container {
            display: flex;
            gap: 20px;
            align-items: center;
            margin: 15px 0;
        }
        .svg-display {
            flex: 0 0 200px;
            height: 150px;
            border: 1px solid #ccc;
            background: #f9f9f9;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .points-display {
            flex: 1;
            background: #f8f8f8;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 120px;
            overflow-y: auto;
        }
        canvas {
            border: 1px solid #ccc;
            background: white;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .controls {
            margin: 15px 0;
        }
        .controls input {
            margin: 0 10px;
            padding: 4px;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .canvas-container {
            position: relative;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: white;
            display: inline-block;
        }
        .visualization-controls {
            margin: 10px 0;
            padding: 12px;
            background: #f5f5f5;
            border-radius: 4px;
            display: flex;
            gap: 20px;
            align-items: center;
            font-size: 14px;
            flex-wrap: wrap;
        }
        .visualization-controls label {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            white-space: nowrap;
        }
        .point-size-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .point-size-control input[type="range"] {
            width: 80px;
        }
        .file-canvas-container {
            margin: 15px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>üé® SVG Path Extractor - Standalone Demo</h1>
    <p>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –ü—Ä–æ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –æ–¥–∏–Ω —Ñ–∞–π–ª!</p>

    <div class="highlight">
        <strong>‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:</strong> –°–∫–æ–ø–∏—Ä—É–π—Ç–µ <code>svg-path-extractor.js</code> –∏–ª–∏ <code>svg-path-extractor.min.js</code> –≤ —Å–≤–æ–π –ø—Ä–æ–µ–∫—Ç
        <br><strong>üé® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</strong> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏ –ª–∏–Ω–∏–π —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
    </div>

    <!-- –î–µ–º–æ 1: –ü—Ä–æ—Å—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ -->
    <div class="demo-section">
        <h2>üîπ –î–µ–º–æ 1: –ë–∞–∑–æ–≤–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ—á–µ–∫</h2>
        
        <div class="svg-container">
            <div class="svg-display">
                <svg width="150" height="100" viewBox="0 0 150 100">
                    <circle cx="75" cy="50" r="30" fill="none" stroke="#e74c3c" stroke-width="2"/>
                </svg>
            </div>
            <div class="points-display" id="demo1-output">
                –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–æ—á–µ–∫...
            </div>
        </div>

        <div class="controls">
            <label>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å —Ç–æ—á–µ–∫:</label>
            <input type="range" id="density1" min="2" max="20" value="8">
            <span id="density1-value">8</span>
            <button onclick="runDemo1()">–ò–∑–≤–ª–µ—á—å —Ç–æ—á–∫–∏</button>
        </div>

        <p><strong>–ö–æ–¥:</strong></p>
        <pre><code>const extractor = new SVGPathExtractor({ pointDensity: 8 });
const paths = await extractor.extractPoints(svgContent);
console.log(`–ü–æ–ª—É—á–µ–Ω–æ ${paths[0].length} —Ç–æ—á–µ–∫`);</code></pre>
    </div>

    <!-- –î–µ–º–æ 2: –°–ª–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º—ã -->
    <div class="demo-section">
        <h2>üîπ –î–µ–º–æ 2: –°–ª–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º—ã –∏ –∞–Ω–∏–º–∞—Ü–∏—è</h2>
        
        <div class="svg-container">
            <div class="svg-display">
                <svg width="150" height="100" viewBox="0 0 150 100">
                    <path d="M 20 50 Q 50 20 80 50 T 130 50" fill="none" stroke="#9b59b6" stroke-width="3"/>
                    <polygon points="10,80 40,80 25,95" fill="none" stroke="#2ecc71" stroke-width="2"/>
                </svg>
            </div>
            <div class="canvas-container">
                <canvas id="demo2-canvas" width="500" height="300"></canvas>
            </div>
        </div>

        <div class="visualization-controls">
            <label>
                <input type="checkbox" id="show-lines-2" checked> –ü–æ–∫–∞–∑–∞—Ç—å –ª–∏–Ω–∏–∏
            </label>
            <label>
                <input type="checkbox" id="show-points-2" checked> –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ—á–∫–∏
            </label>
            <label>
                <input type="checkbox" id="close-paths-2"> –ó–∞–º—ã–∫–∞—Ç—å —Ñ–∏–≥—É—Ä—ã
            </label>
            <div class="point-size-control">
                <label>–†–∞–∑–º–µ—Ä —Ç–æ—á–µ–∫:</label>
                <input type="range" id="point-size-2" min="1" max="6" value="2">
                <span id="point-size-value-2">2</span>px
            </div>
        </div>

        <div class="controls">
            <button onclick="runDemo2()">üé¨ –ê–Ω–∏–º–∞—Ü–∏—è</button>
            <button onclick="drawDemo2Static()">üìä –°—Ç–∞—Ç–∏—á–Ω–æ</button>
            <button onclick="clearDemo2()">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
    </div>

    <!-- –î–µ–º–æ 3: SVG —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ -->
    <div class="demo-section">
        <h2>üîπ –î–µ–º–æ 3: SVG —Å —Ä–∞—Å—Ç—Ä–æ–≤—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</h2>
        <p><small>–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è</small></p>
        
        <div class="svg-container">
            <div class="svg-display">
                <svg width="150" height="100" viewBox="0 0 150 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                    <!-- –†–∞—Å—Ç—Ä–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è) -->
                    <image x="10" y="10" width="30" height="30" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="/>
                    
                    <!-- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
                    <circle cx="75" cy="30" r="15" fill="none" stroke="#e74c3c" stroke-width="2"/>
                    <rect x="50" y="60" width="50" height="25" fill="none" stroke="#3498db" stroke-width="2"/>
                    
                    <!-- –¢–µ–∫—Å—Ç —Ç–æ–∂–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è -->
                    <text x="75" y="95" text-anchor="middle" font-size="8">–¢–µ–∫—Å—Ç –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è</text>
                </svg>
            </div>
            <div class="points-display" id="demo3-output">
                –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏...
            </div>
        </div>

        <div class="controls">
            <button onclick="runDemo3()">–ò–∑–≤–ª–µ—á—å —Ç–æ—á–∫–∏ (–∏–≥–Ω–æ—Ä–∏—Ä—É—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)</button>
        </div>

        <p><strong>–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:</strong></p>
        <ul>
            <li>‚úÖ <code>&lt;circle&gt;</code> –∏ <code>&lt;rect&gt;</code> –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è</li>
            <li>üö´ <code>&lt;image&gt;</code> –∏ <code>&lt;text&gt;</code> –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è</li>
            <li>‚úÖ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤</li>
        </ul>
    </div>

    <!-- –î–µ–º–æ 4: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ -->
    <div class="demo-section">
        <h2>üîπ –î–µ–º–æ 4: –ó–∞–≥—Ä—É–∑–∫–∞ SVG —Ñ–∞–π–ª–∞</h2>
        
        <div class="controls">
            <input type="file" id="svg-file" accept=".svg" onchange="loadSVGFile()">
        </div>
        
                 <div class="visualization-controls" id="file-viz-controls" style="display: none;">
            <label>
                <input type="checkbox" id="show-lines-file" checked> –ü–æ–∫–∞–∑–∞—Ç—å –ª–∏–Ω–∏–∏
            </label>
            <label>
                <input type="checkbox" id="show-points-file" checked> –ü–æ–∫–∞–∑–∞—Ç—å —Ç–æ—á–∫–∏
            </label>
            <label>
                <input type="checkbox" id="close-paths-file"> –ó–∞–º—ã–∫–∞—Ç—å —Ñ–∏–≥—É—Ä—ã
            </label>
            <div class="point-size-control">
                <label>–†–∞–∑–º–µ—Ä —Ç–æ—á–µ–∫:</label>
                <input type="range" id="point-size-file" min="1" max="8" value="3">
                <span id="point-size-value-file">3</span>px
            </div>
            <label>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å:</label>
            <input type="range" id="density-file" min="2" max="15" value="8">
            <span id="density-file-value">8</span>
        </div>
        
        <div class="file-canvas-container">
            <canvas id="file-canvas" width="600" height="450" style="display: none;"></canvas>
        </div>
        
        <div id="file-result" style="margin-top: 15px;">
            –í—ã–±–µ—Ä–∏—Ç–µ SVG —Ñ–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞...
        </div>
    </div>

    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é -->
    <div class="demo-section">
        <h2>üìã –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Å–≤–æ—ë–º –ø—Ä–æ–µ–∫—Ç–µ</h2>
        
        <h3>–í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞–ø—Ä—è–º—É—é</h3>
        <pre><code>&lt;script src="svg-path-extractor.js">&lt;/script>
&lt;script>
  const extractor = new SVGPathExtractor();
  
  // –ò–∑ —Å—Ç—Ä–æ–∫–∏
  const paths = await extractor.extractPoints(svgContent, 5);
  
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
  paths.forEach((path, pathIndex) => {
    console.log(`–ü—É—Ç—å ${pathIndex}: ${path.length} —Ç–æ—á–µ–∫`);
    path.forEach(point => {
      console.log(`–¢–æ—á–∫–∞: x=${point.x}, y=${point.y}`);
    });
  });
&lt;/script></code></pre>

        <h3>–í–∞—Ä–∏–∞–Ω—Ç 2: CDN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ)</h3>
        <pre><code>&lt;script src="https://cdn.jsdelivr.net/gh/yourusername/svg-path-extractor@main/svg-path-extractor.min.js">&lt;/script></code></pre>

        <h3>–í–∞—Ä–∏–∞–Ω—Ç 3: ES6 –º–æ–¥—É–ª–∏ (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã)</h3>
        <pre><code>&lt;script type="module">
  import SVGPathExtractor from './svg-path-extractor.js';
  const extractor = new SVGPathExtractor();
&lt;/script></code></pre>
    </div>

    <!-- –°–ø—Ä–∞–≤–∫–∞ –ø–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ -->
    <div class="demo-section">
        <h2>üé® –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</h2>
        
        <p>–í –¥–µ–º–æ-–≤–µ—Ä—Å–∏–∏ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã:</p>
        <ul>
            <li><strong>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ—á–µ–∫</strong> - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–∞–º–∏ –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Ç–æ—á–∫–∏</li>
            <li><strong>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏–Ω–∏–π</strong> - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏</li>
            <li><strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ —Ç–æ—á–µ–∫</strong> - –æ—Ç 1px –¥–æ 8px</li>
            <li><strong>–ê–Ω–∏–º–∞—Ü–∏—è</strong> - –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –ø—Ä–æ—Ä–∏—Å–æ–≤–∫–∞ –ø—É—Ç–µ–π</li>
            <li><strong>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</strong> - –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
            <li><strong>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤</strong> - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ª—é–±—ã—Ö SVG —Ñ–∞–π–ª–æ–≤</li>
            <li><strong>–ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω</strong> - –≤—Å–µ —É–≥–ª—ã –ø–æ–ª–∏–≥–æ–Ω–æ–≤ –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è</li>
            <li><strong>–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ</strong> - –∑–∞–º–∫–Ω—É—Ç—ã–µ —Ñ–∏–≥—É—Ä—ã –º–æ–≥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—É—é —Ç–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ</li>
        </ul>
        
        <p><strong>üí° –°–æ–≤–µ—Ç:</strong> –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–π SVG —Ñ–∞–π–ª –∏ –ø–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏!</p>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É -->
    <script src="svg-path-extractor.js"></script>
    
    <script>
        // –î–µ–º–æ 1: –ë–∞–∑–æ–≤–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ
        async function runDemo1() {
            const svgContent = `<svg viewBox="0 0 150 100">
                <circle cx="75" cy="50" r="30" fill="none" stroke="#e74c3c"/>
            </svg>`;
            
            const density = parseInt(document.getElementById('density1').value);
            const extractor = new SVGPathExtractor({ pointDensity: density });
            
            try {
                const paths = await extractor.extractPoints(svgContent);
                const output = document.getElementById('demo1-output');
                
                let html = `<strong>–ò–∑–≤–ª–µ—á–µ–Ω–æ ${paths.length} –ø—É—Ç–µ–π:</strong><br>`;
                paths.forEach((path, pathIndex) => {
                    html += `–ü—É—Ç—å ${pathIndex + 1}: ${path.length} —Ç–æ—á–µ–∫<br>`;
                    const preview = path.slice(0, 3);
                    preview.forEach((point, i) => {
                        html += `  [${i}] x: ${point.x.toFixed(1)}, y: ${point.y.toFixed(1)}<br>`;
                    });
                    if (path.length > 3) {
                        html += `  ... –∏ –µ—â—ë ${path.length - 3} —Ç–æ—á–µ–∫<br>`;
                    }
                });
                
                output.innerHTML = html;
            } catch (error) {
                document.getElementById('demo1-output').innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            }
        }

        // –î–µ–º–æ 2: –ê–Ω–∏–º–∞—Ü–∏—è
        let animationId = null;
        let demo2PathsData = null;
        let demo2LastClosePaths = false;
        
        // Utility function for drawing paths
        function drawPaths(canvas, paths, options = {}) {
            const {
                showLines = true,
                showPoints = true,
                pointSize = 2,
                animate = false,
                animationProgress = 1,
                colors = ['#9b59b6', '#2ecc71', '#e74c3c', '#3498db', '#f39c12']
            } = options;
            
            const ctx = canvas.getContext('2d');
            
            // Calculate scale to fit canvas
            let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;
            paths.forEach(path => {
                path.forEach(point => {
                    minX = Math.min(minX, point.x);
                    minY = Math.min(minY, point.y);
                    maxX = Math.max(maxX, point.x);
                    maxY = Math.max(maxY, point.y);
                });
            });
            
            const padding = 20;
            const scaleX = (canvas.width - 2 * padding) / (maxX - minX);
            const scaleY = (canvas.height - 2 * padding) / (maxY - minY);
            const scale = Math.min(scaleX, scaleY);
            
            const offsetX = (canvas.width - (maxX - minX) * scale) / 2 - minX * scale;
            const offsetY = (canvas.height - (maxY - minY) * scale) / 2 - minY * scale;
            
            function transform(point) {
                return {
                    x: point.x * scale + offsetX,
                    y: point.y * scale + offsetY
                };
            }
            
            // Draw lines
            if (showLines) {
                paths.forEach((path, pathIdx) => {
                    if (path.length === 0) return;
                    
                    ctx.strokeStyle = colors[pathIdx % colors.length];
                    ctx.lineWidth = 2;
                    ctx.beginPath();
                    
                    const pointsToShow = animate 
                        ? Math.floor(path.length * animationProgress)
                        : path.length;
                    
                    for (let i = 0; i < pointsToShow; i++) {
                        const transformed = transform(path[i]);
                        if (i === 0) {
                            ctx.moveTo(transformed.x, transformed.y);
                        } else {
                            ctx.lineTo(transformed.x, transformed.y);
                        }
                    }
                    
                    ctx.stroke();
                });
            }
            
            // Draw points
            if (showPoints) {
                paths.forEach((path, pathIdx) => {
                    if (path.length === 0) return;
                    
                    ctx.fillStyle = colors[pathIdx % colors.length];
                    
                    const pointsToShow = animate 
                        ? Math.floor(path.length * animationProgress)
                        : path.length;
                    
                    for (let i = 0; i < pointsToShow; i++) {
                        const transformed = transform(path[i]);
                        ctx.beginPath();
                        ctx.arc(transformed.x, transformed.y, pointSize, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                });
            }
        }
        
        // –î–µ–º–æ 3: SVG —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
        async function runDemo3() {
            const svgWithImages = `<svg viewBox="0 0 150 100" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <!-- –†–∞—Å—Ç—Ä–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
                <image x="10" y="10" width="30" height="30" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="/>
                
                <!-- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
                <circle cx="75" cy="30" r="15" fill="none" stroke="#e74c3c"/>
                <rect x="50" y="60" width="50" height="25" fill="none" stroke="#3498db"/>
                
                <!-- –¢–µ–∫—Å—Ç -->
                <text x="75" y="95" text-anchor="middle">–¢–µ–∫—Å—Ç –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è</text>
            </svg>`;
            
            const extractor = new SVGPathExtractor({ pointDensity: 8 });
            
            try {
                const paths = await extractor.extractPoints(svgWithImages);
                const output = document.getElementById('demo3-output');
                
                let html = `<strong>‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ!</strong><br>`;
                html += `üìä –ò–∑–≤–ª–µ—á–µ–Ω–æ –ø—É—Ç–µ–π: ${paths.length} (circle + rect)<br>`;
                html += `üö´ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç–µ–∫—Å—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã<br><br>`;
                
                paths.forEach((path, pathIndex) => {
                    const elementType = pathIndex === 0 ? 'circle' : 'rect';
                    html += `${elementType}: ${path.length} —Ç–æ—á–µ–∫<br>`;
                });
                
                html += `<br><small>üéØ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã</small>`;
                
                output.innerHTML = html;
            } catch (error) {
                document.getElementById('demo3-output').innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
            }
        }
        
        async function runDemo2() {
            const svgContent = `<svg viewBox="0 0 150 100">
                <path d="M 20 50 Q 50 20 80 50 T 130 50" fill="none" stroke="#9b59b6"/>
                <polygon points="10,80 40,80 25,95" fill="none" stroke="#2ecc71"/>
            </svg>`;
            
            const closePaths = document.getElementById('close-paths-2').checked;
            const extractor = new SVGPathExtractor({ pointDensity: 5, closePaths });
            demo2PathsData = await extractor.extractPoints(svgContent);
            
            const canvas = document.getElementById('demo2-canvas');
            const ctx = canvas.getContext('2d');
            
            const totalPoints = demo2PathsData.reduce((sum, path) => sum + path.length, 0);
            let progress = 0;
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const showLines = document.getElementById('show-lines-2').checked;
                const showPoints = document.getElementById('show-points-2').checked;
                const pointSize = parseInt(document.getElementById('point-size-2').value);
                
                drawPaths(canvas, demo2PathsData, {
                    showLines,
                    showPoints,
                    pointSize,
                    animate: true,
                    animationProgress: progress
                });
                
                progress += 0.01;
                
                if (progress <= 1) {
                    animationId = requestAnimationFrame(animate);
                }
            }
            
            clearDemo2();
            animate();
        }
        
        async function drawDemo2Static() {
            const closePaths = document.getElementById('close-paths-2').checked;
            
            // –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –æ–ø—Ü–∏—è –∑–∞–º—ã–∫–∞–Ω–∏—è
            if (!demo2PathsData || demo2LastClosePaths !== closePaths) {
                const svgContent = `<svg viewBox="0 0 150 100">
                    <path d="M 20 50 Q 50 20 80 50 T 130 50" fill="none" stroke="#9b59b6"/>
                    <polygon points="10,80 40,80 25,95" fill="none" stroke="#2ecc71"/>
                </svg>`;
                
                const extractor = new SVGPathExtractor({ pointDensity: 5, closePaths });
                demo2PathsData = await extractor.extractPoints(svgContent);
                demo2LastClosePaths = closePaths;
            }
            
            clearDemo2();
            
            const canvas = document.getElementById('demo2-canvas');
            const showLines = document.getElementById('show-lines-2').checked;
            const showPoints = document.getElementById('show-points-2').checked;
            const pointSize = parseInt(document.getElementById('point-size-2').value);
            
            drawPaths(canvas, demo2PathsData, {
                showLines,
                showPoints,
                pointSize
            });
        }
        
        function clearDemo2() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            const canvas = document.getElementById('demo2-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // –î–µ–º–æ 4: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
        let filePathsData = null;
        
        async function loadSVGFile() {
            const fileInput = document.getElementById('svg-file');
            const file = fileInput.files[0];
            
            if (!file) return;
            
            try {
                const svgContent = await file.text();
                const density = parseInt(document.getElementById('density-file').value);
                const closePaths = document.getElementById('close-paths-file').checked;
                const extractor = new SVGPathExtractor({ pointDensity: density, closePaths });
                filePathsData = await extractor.extractPoints(svgContent);
                
                const totalPoints = filePathsData.reduce((sum, path) => sum + path.length, 0);
                
                // Show results
                let html = `<h4>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–π–ª–∞ "${file.name}":</h4>`;
                html += `<p><strong>–ò–∑–≤–ª–µ—á–µ–Ω–æ:</strong> ${filePathsData.length} –ø—É—Ç–µ–π —Å ${totalPoints} —Ç–æ—á–∫–∞–º–∏</p>`;
                
                filePathsData.forEach((path, index) => {
                    html += `<p>–ü—É—Ç—å ${index + 1}: ${path.length} —Ç–æ—á–µ–∫</p>`;
                });
                
                if (closePaths) {
                    html += `<p><small>üîó –ó–∞–º—ã–∫–∞–Ω–∏–µ —Ñ–∏–≥—É—Ä –≤–∫–ª—é—á–µ–Ω–æ</small></p>`;
                }
                
                document.getElementById('file-result').innerHTML = html;
                
                // Show visualization controls and canvas
                document.getElementById('file-viz-controls').style.display = 'flex';
                const canvas = document.getElementById('file-canvas');
                canvas.style.display = 'block';
                
                // Draw visualization
                drawFileVisualization();
                
            } catch (error) {
                document.getElementById('file-result').innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                document.getElementById('file-viz-controls').style.display = 'none';
                document.getElementById('file-canvas').style.display = 'none';
            }
        }
        
        function drawFileVisualization() {
            if (!filePathsData) return;
            
            const canvas = document.getElementById('file-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const showLines = document.getElementById('show-lines-file').checked;
            const showPoints = document.getElementById('show-points-file').checked;
            const pointSize = parseInt(document.getElementById('point-size-file').value);
            
            drawPaths(canvas, filePathsData, {
                showLines,
                showPoints,
                pointSize
            });
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
        document.getElementById('density1').addEventListener('input', function() {
            document.getElementById('density1-value').textContent = this.value;
        });
        
        // Event listeners –¥–ª—è –¥–µ–º–æ 2
        document.getElementById('point-size-2').addEventListener('input', function() {
            document.getElementById('point-size-value-2').textContent = this.value;
            if (demo2PathsData) drawDemo2Static();
        });
        
        document.getElementById('show-lines-2').addEventListener('change', function() {
            if (demo2PathsData) drawDemo2Static();
        });
        
        document.getElementById('show-points-2').addEventListener('change', function() {
            if (demo2PathsData) drawDemo2Static();
        });
        
        document.getElementById('close-paths-2').addEventListener('change', function() {
            drawDemo2Static();
        });
        
        // Event listeners –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞
        document.getElementById('point-size-file').addEventListener('input', function() {
            document.getElementById('point-size-value-file').textContent = this.value;
            drawFileVisualization();
        });
        
        document.getElementById('density-file').addEventListener('input', function() {
            document.getElementById('density-file-value').textContent = this.value;
            // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª —Å –Ω–æ–≤–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é
            if (filePathsData) {
                loadSVGFile();
            }
        });
        
        document.getElementById('show-lines-file').addEventListener('change', drawFileVisualization);
        document.getElementById('show-points-file').addEventListener('change', drawFileVisualization);
        document.getElementById('close-paths-file').addEventListener('change', function() {
            if (filePathsData) {
                loadSVGFile(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª —Å –Ω–æ–≤—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
            }
        });
    </script>
</body>
</html> 